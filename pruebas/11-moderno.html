<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Prueba 11: CSS Moderno</title>
    <style>
        .link-volver { display: inline-block; margin-bottom: 20px; text-decoration: none; color: #333; }
    </style>
</head>
<body>
    <a href="../index.html" class="link-volver">← Volver al Índice</a>
    <h1>Prueba 11: CSS Moderno y Selectores Complejos</h1>
    <p>Objetivo: Verificar soporte para características modernas (@container, @layer) y selectores complejos.</p>

    <div id="contenedor-prueba"></div>

    <script type="module">
        import crear_grupo from "../fuente/grupo_de_elementos_para_documentos_de_hipertexto.js"

        const grupo = crear_grupo()
        const contenedor = document.getElementById("contenedor-prueba")

        /* 
           1. @layer 
           Definimos capas para controlar la cascada.
           'base' pierde ante 'utilidad'
        */
        grupo.estilos({
            "@layer base, utilidad": ";", // Declaración de orden (opcional pero buena práctica)
            
            "@layer base": {
                "p": {
                    color: "red", // Este debería perder
                    fontSize: "16px"
                }
            },
            
            "@layer utilidad": {
                "p": {
                    color: "green", // Este debería ganar
                    fontWeight: "bold"
                }
            }
        })

        /* 
           2. @container 
           Necesitamos un contenedor padre declarado como container-type
        */
        const wrapper = grupo.elemento({
            tagName: "div",
            classList: ["wrapper-container"],
            childNodes: [
                grupo.elemento({
                    tagName: "div",
                    classList: ["hijo-responsive"],
                    childNodes: ["Soy sensible a mi contenedor (Verde si ancho > 300px)"]
                })
            ]
        })

        grupo.estilos({
            ".wrapper-container": {
                containerType: "inline-size",
                width: "100%",
                maxWidth: "500px",
                border: "2px dashed #ccc",
                padding: "10px",
                resize: "horizontal", // Permitir redimensionar para probar
                overflow: "hidden",
                marginBottom: "20px"
            },
            ".hijo-responsive": {
                backgroundColor: "salmon", // Fallback
                color: "white",
                padding: "10px"
            },
            "@container (min-width: 300px)": {
                ".hijo-responsive": {
                    backgroundColor: "seagreen",
                    content: '"Soy ancho!"'
                }
            }
        })

        /*
           3. Selectores Lógicos (:is, :where, :has, :not)
        */
        const lista = grupo.elemento({
            tagName: "ul",
            classList: ["lista-logica"],
            childNodes: [
                grupo.elemento({ tagName: "li", classList: ["item", "especial"], childNodes: ["Item Especial (:is/.especial) -> Azul"] }),
                grupo.elemento({ tagName: "li", classList: ["item"], childNodes: ["Item Normal"] }),
                grupo.elemento({ tagName: "li", classList: ["item", "ignorado"], childNodes: ["Item Ignorado (:not/.ignorado) -> Sin borde"] }),
                grupo.elemento({ 
                    tagName: "li", 
                    classList: ["item", "padre-has"], 
                    childNodes: [
                        "Item Padre (:has) -> Borde rojo grueso",
                        grupo.elemento({ tagName: "span", childNodes: [" (Hijo detonante)"] })
                    ]
                })
            ]
        })

        grupo.estilos({
            ".lista-logica": {
                listStyle: "none",
                padding: "0"
            },
            /* Prueba de :is() y anidamiento */
            ":is(.item)": {
                padding: "5px",
                margin: "5px 0",
                border: "1px solid #ddd"
            },
            /* Prueba de :is con selector anidado */
            ".lista-logica :is(.especial)": {
                color: "blue",
                fontWeight: "bold"
            },
            /* Prueba de :not() */
            ".item:not(.ignorado)": {
                borderLeft: "5px solid #aaa"
            },
            /* Prueba de :has() - Selecciona al padre si tiene un hijo span */
            ".item:has(span)": {
                borderColor: "red",
                borderWidth: "3px"
            },
            /* Prueba de selectores de atributos complejos */
            '[class*="padre"]': {
                backgroundColor: "#fff0f0"
            }
        })

        contenedor.appendChild(grupo.elemento({ tagName: "h3", childNodes: ["1. Prueba de @layer (Cascada)"] }))
        contenedor.appendChild(grupo.elemento({ tagName: "p", childNodes: ["Este texto debería ser VERDE (gana @layer utilidad) y no ROJO."] }))
        
        contenedor.appendChild(grupo.elemento({ tagName: "h3", childNodes: ["2. Prueba de @container (Queries)"] }))
        contenedor.appendChild(grupo.elemento({ tagName: "p", childNodes: ["Redimensiona el contenedor punteado. Si es ancho (>300px) será VERDE, si es estrecho será SALMÓN."] }))
        contenedor.appendChild(wrapper)

        contenedor.appendChild(grupo.elemento({ tagName: "h3", childNodes: ["3. Prueba de Selectores Lógicos (:is, :not, :has)"] }))
        contenedor.appendChild(lista)

    </script>
</body>
</html>